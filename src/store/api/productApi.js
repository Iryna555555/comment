import { createAsyncThunk } from '@reduxjs/toolkit';
// –í —ç—Ç–æ–π –ø–∞–ø–∫–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç –¥–∞–Ω–Ω—ã–µ
//  —Å —Å–µ—Ä–≤–µ—Ä–∞. –≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç fetch() –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –¥–∞–Ω–Ω—ã—Ö –∏ 
// createAsyncThunk –∏–∑ @reduxjs/toolkit, —á—Ç–æ–±—ã Redux –º–æ–≥ —É–ø—Ä–∞–≤–ª—è—Ç—å –∏—Ö 
// —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º.

export const fetchProducts = createAsyncThunk( //–°–æ–∑–¥–∞—ë–º fetchProducts ‚Äì –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤
  // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º createAsyncThunk 
  // createAsyncThunk ‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –∏–∑ Redux Toolkit, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–∑–¥–∞—ë—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è.
  // –û–Ω–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç Redux –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–ø—Ä–æ—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "loading", "succeeded", "failed").
  // "loading" ‚Äì –∏–¥—ë—Ç –∑–∞–≥—Ä—É–∑–∫–∞ (–¥–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–∞).
  // "succeeded" ‚Äì —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ (–¥–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ state).
  // "failed" ‚Äì –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ (—Å–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª, –æ—à–∏–±–∫–∞ —Å–µ—Ç–∏ –∏ —Ç. –¥.).
  'products/fetchProducts', //–∏–º—è –¥–µ–π—Å—Ç–≤–∏—è Redux.
  async () => { // async () => {} ‚Äì —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ.
    const response = await fetch('https://exam-server-5c4e.onrender.com/products/all');
    // fetch('https://exam-server-5c4e.onrender.com/products/all') ‚Äì –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –≤—Å–µ —Ç–æ–≤–∞—Ä—ã.
    // await ‚Äì –∂–¥—ë–º, –ø–æ–∫–∞ —Å–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—Ç–∏—Ç.
    if (!response.ok) {
      throw new Error(`HTTP error! Status: ${response.status}`);
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É—Å–ø–µ—à–Ω–æ –ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ
      // –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É (404, 500 –∏ —Ç. –¥.), –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É.
      // throw new Error() ‚Äì –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –∏ –ø–µ—Ä–µ–¥–∞—ë—Ç –æ—à–∏–±–∫—É –≤ catch.
    }
    const data = await response.json();
    //–ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –æ—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –≤ JSON
    // await response.json() ‚Äì –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –≤ –º–∞—Å—Å–∏–≤ —Ç–æ–≤–∞—Ä–æ–≤.

    localStorage.setItem('products', JSON.stringify(data));
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –±—Ä–∞—É–∑–µ—Ä.
    // –í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ —Ç–æ–≤–∞—Ä—ã –º–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ localStorage, –Ω–µ –æ–±—Ä–∞—â–∞—è—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É.

    return data;
    // return data; ‚Äì Redux –ø–æ–ª—É—á–∏—Ç —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç –µ–≥–æ –≤ store.products.
  }
);

// üî• –ò—Ç–æ–≥
// ‚úÖ category.js –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π.
// ‚úÖ productApi.js –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ localStorage.
// ‚úÖ –û–±–∞ —Ñ–∞–π–ª–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç fetch() –∏ createAsyncThunk, —á—Ç–æ–±—ã Redux —Å–ª–µ–¥–∏–ª –∑–∞ —Å—Ç–∞—Ç—É—Å–æ–º –∑–∞–≥—Ä—É–∑–∫–∏.


